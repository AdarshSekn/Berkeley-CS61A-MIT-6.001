This file is a merged representation of the entire codebase, combined into a single document by Repomix.
The content has been processed where security check has been disabled.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Security check has been disabled - content may contain sensitive information
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
picture_language/
  pictures/
    bones.scm
    colored-escher.scm
    colorpic.scm
    escher.scm
    shapes.scm
  2.44.scm
  2.45.scm
  2.46.scm
  2.47.scm
  2.48.scm
  2.49.scm
  2.50.scm
  2.51.scm
  2.52.scm
  below.scm
  frame.scm
  painter-transforms.scm
  painters.scm
  picture.scm
  segment.scm
  split.scm
  up-split.scm
  vect.scm
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="picture_language/pictures/bones.scm">
;; Rasterized by Glenn Sugden

(define bones
  (segments->painter
   (list
    (make-segment (make-vect 0.875 0.014) (make-vect 0.875 0.018))
    (make-segment (make-vect 0.875 0.018) (make-vect 0.879 0.018))
    (make-segment (make-vect 0.879 0.018) (make-vect 0.879 0.014))
    (make-segment (make-vect 0.879 0.014) (make-vect 0.875 0.014))
    (make-segment (make-vect 0.875 0.014) (make-vect 0.875 0.01))
    (make-segment (make-vect 0.875 0.01) (make-vect 0.857 0.01))
    (make-segment (make-vect 0.857 0.01) (make-vect 0.847 0.018))
    (make-segment (make-vect 0.847 0.018) (make-vect 0.853 0.024))
    (make-segment (make-vect 0.879 0.014) (make-vect 0.891 0.018))
    (make-segment (make-vect 0.891 0.018) (make-vect 0.901 0.036))
    (make-segment (make-vect 0.901 0.036) (make-vect 0.927 0.02))
    (make-segment (make-vect 0.927 0.02) (make-vect 0.931 0.014))   
    (make-segment (make-vect 0.931 0.014) (make-vect 0.943 0.016))
    (make-segment (make-vect 0.943 0.016) (make-vect 0.947 0.024))
    (make-segment (make-vect 0.947 0.024) (make-vect 0.945 0.052))
    (make-segment (make-vect 0.945 0.052) (make-vect 0.941 0.06))
    (make-segment (make-vect 0.941 0.06) (make-vect 0.943 0.076))
    (make-segment (make-vect 0.943 0.076) (make-vect 0.965 0.092))
    (make-segment (make-vect 0.965 0.092) (make-vect 0.969 0.098))
    (make-segment (make-vect 0.969 0.098) (make-vect 0.971 0.112))
    (make-segment (make-vect 0.971 0.112) (make-vect 0.991 0.134))
    (make-segment (make-vect 0.991 0.134) (make-vect 0.991 0.164))
    (make-segment (make-vect 0.991 0.164) (make-vect 0.979 0.187))
    (make-segment (make-vect 0.979 0.187) (make-vect 0.961 0.199))
    (make-segment (make-vect 0.961 0.199) (make-vect 0.869 0.221))
    (make-segment (make-vect 0.869 0.221) (make-vect 0.832 0.229))
    (make-segment (make-vect 0.832 0.229) (make-vect 0.782 0.253))
    (make-segment (make-vect 0.782 0.253) (make-vect 0.67 0.338))
    (make-segment (make-vect 0.67 0.338) (make-vect 0.688 0.37))
    (make-segment (make-vect 0.688 0.37) (make-vect 0.704 0.386))
    (make-segment (make-vect 0.704 0.386) (make-vect 0.698 0.412))
    (make-segment (make-vect 0.698 0.412) (make-vect 0.696 0.436))
    (make-segment (make-vect 0.696 0.436) (make-vect 0.688 0.434))
    (make-segment (make-vect 0.688 0.434) (make-vect 0.68 0.426))
    (make-segment (make-vect 0.68 0.426) (make-vect 0.67 0.442))
    (make-segment (make-vect 0.67 0.442) (make-vect 0.67 0.446))
    (make-segment (make-vect 0.154 0.016) (make-vect 0.162 0.018))
    (make-segment (make-vect 0.162 0.018) (make-vect 0.173 0.028))
    (make-segment (make-vect 0.173 0.028) (make-vect 0.175 0.068))
    (make-segment (make-vect 0.175 0.068) (make-vect 0.201 0.118))
    (make-segment (make-vect 0.201 0.118) (make-vect 0.241 0.167))
    (make-segment (make-vect 0.241 0.167) (make-vect 0.239 0.175))
    (make-segment (make-vect 0.239 0.175) (make-vect 0.235 0.177))
    (make-segment (make-vect 0.235 0.177) (make-vect 0.257 0.199))
    (make-segment (make-vect 0.257 0.199) (make-vect 0.265 0.199))
    (make-segment (make-vect 0.265 0.199) (make-vect 0.265 0.193))
    (make-segment (make-vect 0.265 0.193) (make-vect 0.261 0.197))
    (make-segment (make-vect 0.261 0.197) (make-vect 0.263 0.197))
    (make-segment (make-vect 0.263 0.197) (make-vect 0.265 0.193))
    (make-segment (make-vect 0.154 0.016) (make-vect 0.15 0.008))
    (make-segment (make-vect 0.15 0.008) (make-vect 0.144 0.004))
    (make-segment (make-vect 0.144 0.004) (make-vect 0.118 0.008))
    (make-segment (make-vect 0.118 0.008) (make-vect 0.104 0.028))
    (make-segment (make-vect 0.104 0.028) (make-vect 0.104 0.032))
    (make-segment (make-vect 0.104 0.032) (make-vect 0.12 0.044))
    (make-segment (make-vect 0.12 0.044) (make-vect 0.136 0.05))
    (make-segment (make-vect 0.154 0.016) (make-vect 0.152 0.016))
    (make-segment (make-vect 0.152 0.016) (make-vect 0.15 0.018))
    (make-segment (make-vect 0.15 0.018) (make-vect 0.15 0.02))
    (make-segment (make-vect 0.15 0.02) (make-vect 0.144 0.02))
    (make-segment (make-vect 0.154 0.016) (make-vect 0.152 0.018))
    (make-segment (make-vect 0.847 0.02) (make-vect 0.828 0.03))
    (make-segment (make-vect 0.828 0.03) (make-vect 0.828 0.048))
    (make-segment (make-vect 0.828 0.048) (make-vect 0.828 0.07))
    (make-segment (make-vect 0.828 0.07) (make-vect 0.81 0.106))
    (make-segment (make-vect 0.81 0.106) (make-vect 0.776 0.152))
    (make-segment (make-vect 0.776 0.152) (make-vect 0.742 0.189))
    (make-segment (make-vect 0.742 0.189) (make-vect 0.71 0.219))
    (make-segment (make-vect 0.71 0.219) (make-vect 0.708 0.227))
    (make-segment (make-vect 0.708 0.227) (make-vect 0.655 0.273))
    (make-segment (make-vect 0.655 0.273) (make-vect 0.641 0.273))
    (make-segment (make-vect 0.641 0.273) (make-vect 0.641 0.245))
    (make-segment (make-vect 0.641 0.245) (make-vect 0.641 0.211))
    (make-segment (make-vect 0.641 0.211) (make-vect 0.635 0.205))
    (make-segment (make-vect 0.635 0.205) (make-vect 0.627 0.207))
    (make-segment (make-vect 0.627 0.207) (make-vect 0.619 0.211))
    (make-segment (make-vect 0.619 0.211) (make-vect 0.609 0.209))
    (make-segment (make-vect 0.609 0.209) (make-vect 0.611 0.219))
    (make-segment (make-vect 0.611 0.219) (make-vect 0.619 0.219))
    (make-segment (make-vect 0.619 0.219) (make-vect 0.621 0.211))
    (make-segment (make-vect 0.901 0.036) (make-vect 0.885 0.05))
    (make-segment (make-vect 0.06 0.04) (make-vect 0.064 0.07))
    (make-segment (make-vect 0.064 0.07) (make-vect 0.052 0.082))
    (make-segment (make-vect 0.052 0.082) (make-vect 0.046 0.086))
    (make-segment (make-vect 0.046 0.086) (make-vect 0.036 0.096))
    (make-segment (make-vect 0.036 0.096) (make-vect 0.034 0.11))
    (make-segment (make-vect 0.034 0.11) (make-vect 0.016 0.126))
    (make-segment (make-vect 0.016 0.126) (make-vect 0.008 0.14))
    (make-segment (make-vect 0.008 0.14) (make-vect 0.01 0.156))
    (make-segment (make-vect 0.01 0.156) (make-vect 0.04 0.197))
    (make-segment (make-vect 0.04 0.197) (make-vect 0.05 0.203))
    (make-segment (make-vect 0.05 0.203) (make-vect 0.1 0.209))
    (make-segment (make-vect 0.1 0.209) (make-vect 0.144 0.213))
    (make-segment (make-vect 0.144 0.213) (make-vect 0.152 0.211))
    (make-segment (make-vect 0.152 0.211) (make-vect 0.185 0.223))
    (make-segment (make-vect 0.185 0.223) (make-vect 0.243 0.259))
    (make-segment (make-vect 0.243 0.259) (make-vect 0.299 0.301))
    (make-segment (make-vect 0.299 0.301) (make-vect 0.321 0.321))
    (make-segment (make-vect 0.321 0.321) (make-vect 0.386 0.321))
    (make-segment (make-vect 0.386 0.321) (make-vect 0.392 0.307))
    (make-segment (make-vect 0.392 0.307) (make-vect 0.376 0.295))
    (make-segment (make-vect 0.376 0.295) (make-vect 0.366 0.307))
    (make-segment (make-vect 0.366 0.307) (make-vect 0.364 0.323))
    (make-segment (make-vect 0.06 0.04) (make-vect 0.068 0.04))
    (make-segment (make-vect 0.06 0.04) (make-vect 0.06 0.018))
    (make-segment (make-vect 0.06 0.018) (make-vect 0.07 0.01))
    (make-segment (make-vect 0.07 0.01) (make-vect 0.086 0.026))
    (make-segment (make-vect 0.086 0.026) (make-vect 0.1 0.028))
    (make-segment (make-vect 0.116 0.042) (make-vect 0.116 0.058))
    (make-segment (make-vect 0.116 0.042) (make-vect 0.114 0.042))
    (make-segment (make-vect 0.175 0.042) (make-vect 0.169 0.042))
    (make-segment (make-vect 0.169 0.042) (make-vect 0.167 0.04))
    (make-segment (make-vect 0.167 0.04) (make-vect 0.167 0.038))
    (make-segment (make-vect 0.062 0.05) (make-vect 0.074 0.05))
    (make-segment (make-vect 0.036 0.106) (make-vect 0.056 0.112))
    (make-segment (make-vect 0.056 0.112) (make-vect 0.066 0.124))
    (make-segment (make-vect 0.036 0.106) (make-vect 0.034 0.106))
    (make-segment (make-vect 0.969 0.112) (make-vect 0.951 0.12))
    (make-segment (make-vect 0.951 0.12) (make-vect 0.949 0.122))
    (make-segment (make-vect 0.241 0.169) (make-vect 0.255 0.181))
    (make-segment (make-vect 0.255 0.181) (make-vect 0.265 0.189))
    (make-segment (make-vect 0.265 0.189) (make-vect 0.265 0.193))
    (make-segment (make-vect 0.241 0.169) (make-vect 0.239 0.171))
    (make-segment (make-vect 0.239 0.171) (make-vect 0.237 0.173))
    (make-segment (make-vect 0.237 0.173) (make-vect 0.237 0.175))
    (make-segment (make-vect 0.237 0.175) (make-vect 0.237 0.177))
    (make-segment (make-vect 0.613 0.195) (make-vect 0.613 0.203))
    (make-segment (make-vect 0.613 0.203) (make-vect 0.611 0.205))
    (make-segment (make-vect 0.611 0.205) (make-vect 0.611 0.209))
    (make-segment (make-vect 0.613 0.195) (make-vect 0.623 0.195))
    (make-segment (make-vect 0.623 0.195) (make-vect 0.625 0.197))
    (make-segment (make-vect 0.625 0.197) (make-vect 0.627 0.197))
    (make-segment (make-vect 0.627 0.197) (make-vect 0.627 0.199))
    (make-segment (make-vect 0.627 0.199) (make-vect 0.629 0.201))
    (make-segment (make-vect 0.629 0.201) (make-vect 0.629 0.205))
    (make-segment (make-vect 0.613 0.195) (make-vect 0.609 0.181))
    (make-segment (make-vect 0.609 0.181) (make-vect 0.599 0.167))
    (make-segment (make-vect 0.599 0.167) (make-vect 0.561 0.134))
    (make-segment (make-vect 0.561 0.134) (make-vect 0.519 0.108))
    (make-segment (make-vect 0.519 0.108) (make-vect 0.488 0.108))
    (make-segment (make-vect 0.488 0.108) (make-vect 0.478 0.11))
    (make-segment (make-vect 0.478 0.11) (make-vect 0.444 0.114))
    (make-segment (make-vect 0.444 0.114) (make-vect 0.412 0.144))
    (make-segment (make-vect 0.412 0.144) (make-vect 0.402 0.156))
    (make-segment (make-vect 0.402 0.156) (make-vect 0.384 0.171))
    (make-segment (make-vect 0.384 0.171) (make-vect 0.36 0.203))
    (make-segment (make-vect 0.36 0.203) (make-vect 0.366 0.233))
    (make-segment (make-vect 0.366 0.233) (make-vect 0.358 0.251))
    (make-segment (make-vect 0.358 0.251) (make-vect 0.356 0.289))
    (make-segment (make-vect 0.356 0.289) (make-vect 0.352 0.321))
    (make-segment (make-vect 0.267 0.197) (make-vect 0.275 0.201))
    (make-segment (make-vect 0.275 0.201) (make-vect 0.277 0.209))
    (make-segment (make-vect 0.277 0.209) (make-vect 0.334 0.253))
    (make-segment (make-vect 0.334 0.253) (make-vect 0.34 0.249))
    (make-segment (make-vect 0.34 0.249) (make-vect 0.342 0.223))
    (make-segment (make-vect 0.342 0.223) (make-vect 0.348 0.219))
    (make-segment (make-vect 0.348 0.219) (make-vect 0.354 0.227))
    (make-segment (make-vect 0.354 0.227) (make-vect 0.362 0.239))
    (make-segment (make-vect 0.267 0.197) (make-vect 0.269 0.199))
    (make-segment (make-vect 0.269 0.199) (make-vect 0.269 0.203))
    (make-segment (make-vect 0.269 0.203) (make-vect 0.271 0.205))
    (make-segment (make-vect 0.271 0.205) (make-vect 0.273 0.205))
    (make-segment (make-vect 0.273 0.205) (make-vect 0.271 0.203))
    (make-segment (make-vect 0.271 0.203) (make-vect 0.273 0.201))
    (make-segment (make-vect 0.265 0.199) (make-vect 0.265 0.201))
    (make-segment (make-vect 0.265 0.201) (make-vect 0.269 0.201))
    (make-segment (make-vect 0.464 0.203) (make-vect 0.462 0.227))
    (make-segment (make-vect 0.462 0.227) (make-vect 0.468 0.229))
    (make-segment (make-vect 0.468 0.229) (make-vect 0.468 0.261))
    (make-segment (make-vect 0.468 0.261) (make-vect 0.444 0.265))
    (make-segment (make-vect 0.444 0.265) (make-vect 0.422 0.261))
    (make-segment (make-vect 0.422 0.261) (make-vect 0.424 0.247))
    (make-segment (make-vect 0.424 0.247) (make-vect 0.426 0.247))
    (make-segment (make-vect 0.426 0.247) (make-vect 0.43 0.239))
    (make-segment (make-vect 0.43 0.239) (make-vect 0.424 0.223))
    (make-segment (make-vect 0.424 0.223) (make-vect 0.436 0.215))
    (make-segment (make-vect 0.436 0.215) (make-vect 0.448 0.209))
    (make-segment (make-vect 0.448 0.209) (make-vect 0.454 0.201))
    (make-segment (make-vect 0.454 0.201) (make-vect 0.517 0.203))
    (make-segment (make-vect 0.517 0.203) (make-vect 0.521 0.207))
    (make-segment (make-vect 0.521 0.207) (make-vect 0.527 0.203))
    (make-segment (make-vect 0.527 0.203) (make-vect 0.537 0.203))
    (make-segment (make-vect 0.537 0.203) (make-vect 0.541 0.213))
    (make-segment (make-vect 0.541 0.213) (make-vect 0.549 0.215))
    (make-segment (make-vect 0.549 0.215) (make-vect 0.553 0.221))
    (make-segment (make-vect 0.553 0.221) (make-vect 0.561 0.223))
    (make-segment (make-vect 0.561 0.223) (make-vect 0.561 0.239))
    (make-segment (make-vect 0.561 0.239) (make-vect 0.555 0.265))
    (make-segment (make-vect 0.555 0.265) (make-vect 0.547 0.267))
    (make-segment (make-vect 0.547 0.267) (make-vect 0.547 0.277))
    (make-segment (make-vect 0.464 0.203) (make-vect 0.466 0.201))
    (make-segment (make-vect 0.478 0.203) (make-vect 0.476 0.227))
    (make-segment (make-vect 0.476 0.227) (make-vect 0.519 0.229))
    (make-segment (make-vect 0.519 0.229) (make-vect 0.541 0.229))
    (make-segment (make-vect 0.541 0.229) (make-vect 0.541 0.213))
    (make-segment (make-vect 0.488 0.203) (make-vect 0.488 0.227))
    (make-segment (make-vect 0.505 0.203) (make-vect 0.505 0.227))
    (make-segment (make-vect 0.36 0.207) (make-vect 0.358 0.207))
    (make-segment (make-vect 0.358 0.207) (make-vect 0.356 0.209))
    (make-segment (make-vect 0.356 0.209) (make-vect 0.352 0.209))
    (make-segment (make-vect 0.352 0.209) (make-vect 0.35 0.211))
    (make-segment (make-vect 0.35 0.211) (make-vect 0.348 0.213))
    (make-segment (make-vect 0.348 0.213) (make-vect 0.348 0.219))
    (make-segment (make-vect 0.521 0.207) (make-vect 0.521 0.213))
    (make-segment (make-vect 0.521 0.213) (make-vect 0.519 0.215))
    (make-segment (make-vect 0.519 0.215) (make-vect 0.519 0.229))
    (make-segment (make-vect 0.144 0.211) (make-vect 0.142 0.205))
    (make-segment (make-vect 0.142 0.205) (make-vect 0.092 0.197))
    (make-segment (make-vect 0.446 0.211) (make-vect 0.444 0.229))
    (make-segment (make-vect 0.444 0.229) (make-vect 0.438 0.231))
    (make-segment (make-vect 0.438 0.231) (make-vect 0.436 0.239))
    (make-segment (make-vect 0.436 0.239) (make-vect 0.43 0.239))
    (make-segment (make-vect 0.541 0.213) (make-vect 0.541 0.211))
    (make-segment (make-vect 0.434 0.219) (make-vect 0.436 0.221))
    (make-segment (make-vect 0.436 0.221) (make-vect 0.436 0.225))
    (make-segment (make-vect 0.436 0.225) (make-vect 0.438 0.227))
    (make-segment (make-vect 0.438 0.227) (make-vect 0.438 0.231))
    (make-segment (make-vect 0.553 0.221) (make-vect 0.549 0.239))
    (make-segment (make-vect 0.549 0.239) (make-vect 0.559 0.243))
    (make-segment (make-vect 0.613 0.221) (make-vect 0.625 0.299))
    (make-segment (make-vect 0.625 0.299) (make-vect 0.633 0.311))
    (make-segment (make-vect 0.633 0.311) (make-vect 0.639 0.311))
    (make-segment (make-vect 0.639 0.311) (make-vect 0.643 0.281))
    (make-segment (make-vect 0.643 0.281) (make-vect 0.645 0.275))
    (make-segment (make-vect 0.71 0.225) (make-vect 0.712 0.225))
    (make-segment (make-vect 0.712 0.225) (make-vect 0.726 0.219))
    (make-segment (make-vect 0.726 0.219) (make-vect 0.764 0.189))
    (make-segment (make-vect 0.764 0.189) (make-vect 0.816 0.134))
    (make-segment (make-vect 0.816 0.134) (make-vect 0.832 0.104))
    (make-segment (make-vect 0.832 0.104) (make-vect 0.835 0.096))
    (make-segment (make-vect 0.71 0.225) (make-vect 0.708 0.225))
    (make-segment (make-vect 0.424 0.227) (make-vect 0.416 0.229))
    (make-segment (make-vect 0.416 0.229) (make-vect 0.416 0.245))
    (make-segment (make-vect 0.416 0.245) (make-vect 0.416 0.251))
    (make-segment (make-vect 0.416 0.251) (make-vect 0.39 0.263))
    (make-segment (make-vect 0.39 0.263) (make-vect 0.384 0.269))
    (make-segment (make-vect 0.384 0.269) (make-vect 0.378 0.265))
    (make-segment (make-vect 0.378 0.265) (make-vect 0.382 0.253))
    (make-segment (make-vect 0.446 0.227) (make-vect 0.458 0.229))
    (make-segment (make-vect 0.458 0.229) (make-vect 0.462 0.227))
    (make-segment (make-vect 0.476 0.227) (make-vect 0.47 0.227))
    (make-segment (make-vect 0.47 0.227) (make-vect 0.468 0.229))
    (make-segment (make-vect 0.488 0.227) (make-vect 0.492 0.255))
    (make-segment (make-vect 0.492 0.255) (make-vect 0.519 0.261))
    (make-segment (make-vect 0.519 0.261) (make-vect 0.531 0.265))
    (make-segment (make-vect 0.531 0.265) (make-vect 0.535 0.269))
    (make-segment (make-vect 0.535 0.269) (make-vect 0.545 0.269))
    (make-segment (make-vect 0.513 0.229) (make-vect 0.513 0.259))
    (make-segment (make-vect 0.541 0.229) (make-vect 0.541 0.231))
    (make-segment (make-vect 0.541 0.231) (make-vect 0.543 0.233))
    (make-segment (make-vect 0.543 0.233) (make-vect 0.545 0.235))
    (make-segment (make-vect 0.545 0.235) (make-vect 0.549 0.235))
    (make-segment (make-vect 0.563 0.229) (make-vect 0.569 0.231))
    (make-segment (make-vect 0.569 0.231) (make-vect 0.573 0.237))
    (make-segment (make-vect 0.573 0.237) (make-vect 0.575 0.251))
    (make-segment (make-vect 0.575 0.251) (make-vect 0.579 0.255))
    (make-segment (make-vect 0.579 0.255) (make-vect 0.587 0.255))
    (make-segment (make-vect 0.587 0.255) (make-vect 0.585 0.271))
    (make-segment (make-vect 0.585 0.271) (make-vect 0.581 0.277))
    (make-segment (make-vect 0.581 0.277) (make-vect 0.581 0.317))
    (make-segment (make-vect 0.581 0.317) (make-vect 0.591 0.325))
    (make-segment (make-vect 0.591 0.325) (make-vect 0.623 0.325))
    (make-segment (make-vect 0.623 0.325) (make-vect 0.633 0.321))
    (make-segment (make-vect 0.633 0.321) (make-vect 0.639 0.317))
    (make-segment (make-vect 0.639 0.317) (make-vect 0.655 0.331))
    (make-segment (make-vect 0.655 0.331) (make-vect 0.665 0.336))
    (make-segment (make-vect 0.456 0.231) (make-vect 0.456 0.243))
    (make-segment (make-vect 0.456 0.243) (make-vect 0.454 0.245))
    (make-segment (make-vect 0.454 0.245) (make-vect 0.454 0.263))
    (make-segment (make-vect 0.527 0.231) (make-vect 0.531 0.253))
    (make-segment (make-vect 0.531 0.253) (make-vect 0.529 0.263))
    (make-segment (make-vect 0.414 0.235) (make-vect 0.406 0.237))
    (make-segment (make-vect 0.406 0.237) (make-vect 0.4 0.243))
    (make-segment (make-vect 0.4 0.243) (make-vect 0.402 0.255))
    (make-segment (make-vect 0.436 0.239) (make-vect 0.438 0.241))
    (make-segment (make-vect 0.438 0.241) (make-vect 0.438 0.251))
    (make-segment (make-vect 0.438 0.251) (make-vect 0.44 0.253))
    (make-segment (make-vect 0.44 0.253) (make-vect 0.44 0.263))
    (make-segment (make-vect 0.549 0.239) (make-vect 0.547 0.239))
    (make-segment (make-vect 0.547 0.239) (make-vect 0.547 0.263))
    (make-segment (make-vect 0.404 0.241) (make-vect 0.406 0.243))
    (make-segment (make-vect 0.406 0.243) (make-vect 0.406 0.251))
    (make-segment (make-vect 0.406 0.251) (make-vect 0.408 0.253))
    (make-segment (make-vect 0.408 0.253) (make-vect 0.408 0.251))
    (make-segment (make-vect 0.408 0.251) (make-vect 0.406 0.251))
    (make-segment (make-vect 0.573 0.241) (make-vect 0.581 0.245))
    (make-segment (make-vect 0.581 0.245) (make-vect 0.585 0.255))
    (make-segment (make-vect 0.559 0.247) (make-vect 0.561 0.247))
    (make-segment (make-vect 0.561 0.247) (make-vect 0.563 0.249))
    (make-segment (make-vect 0.563 0.249) (make-vect 0.573 0.249))
    (make-segment (make-vect 0.418 0.249) (make-vect 0.422 0.249))
    (make-segment (make-vect 0.422 0.249) (make-vect 0.424 0.249))
    (make-segment (make-vect 0.424 0.249) (make-vect 0.426 0.251))
    (make-segment (make-vect 0.426 0.251) (make-vect 0.428 0.253))
    (make-segment (make-vect 0.428 0.253) (make-vect 0.428 0.257))
    (make-segment (make-vect 0.428 0.257) (make-vect 0.43 0.259))
    (make-segment (make-vect 0.43 0.259) (make-vect 0.43 0.263))
    (make-segment (make-vect 0.565 0.249) (make-vect 0.565 0.269))
    (make-segment (make-vect 0.565 0.269) (make-vect 0.581 0.275))
    (make-segment (make-vect 0.406 0.251) (make-vect 0.404 0.253))
    (make-segment (make-vect 0.404 0.253) (make-vect 0.404 0.255))
    (make-segment (make-vect 0.334 0.253) (make-vect 0.338 0.281))
    (make-segment (make-vect 0.338 0.281) (make-vect 0.334 0.297))
    (make-segment (make-vect 0.334 0.297) (make-vect 0.334 0.323))
    (make-segment (make-vect 0.49 0.253) (make-vect 0.478 0.261))
    (make-segment (make-vect 0.478 0.261) (make-vect 0.47 0.259))
    (make-segment (make-vect 0.49 0.253) (make-vect 0.488 0.255))
    (make-segment (make-vect 0.402 0.255) (make-vect 0.402 0.257))
    (make-segment (make-vect 0.402 0.257) (make-vect 0.404 0.255))
    (make-segment (make-vect 0.404 0.255) (make-vect 0.408 0.277))
    (make-segment (make-vect 0.408 0.277) (make-vect 0.41 0.277))
    (make-segment (make-vect 0.41 0.277) (make-vect 0.414 0.275))
    (make-segment (make-vect 0.414 0.275) (make-vect 0.412 0.255))
    (make-segment (make-vect 0.579 0.255) (make-vect 0.579 0.257))
    (make-segment (make-vect 0.579 0.257) (make-vect 0.577 0.259))
    (make-segment (make-vect 0.577 0.259) (make-vect 0.575 0.261))
    (make-segment (make-vect 0.575 0.261) (make-vect 0.575 0.263))
    (make-segment (make-vect 0.575 0.263) (make-vect 0.573 0.265))
    (make-segment (make-vect 0.573 0.265) (make-vect 0.573 0.269))
    (make-segment (make-vect 0.579 0.255) (make-vect 0.577 0.257))
    (make-segment (make-vect 0.47 0.259) (make-vect 0.468 0.259))
    (make-segment (make-vect 0.426 0.263) (make-vect 0.426 0.265))
    (make-segment (make-vect 0.426 0.265) (make-vect 0.424 0.267))
    (make-segment (make-vect 0.424 0.267) (make-vect 0.424 0.269))
    (make-segment (make-vect 0.424 0.269) (make-vect 0.422 0.271))
    (make-segment (make-vect 0.422 0.271) (make-vect 0.414 0.271))
    (make-segment (make-vect 0.454 0.263) (make-vect 0.452 0.265))
    (make-segment (make-vect 0.555 0.265) (make-vect 0.557 0.267))
    (make-segment (make-vect 0.557 0.267) (make-vect 0.563 0.267))
    (make-segment (make-vect 0.563 0.267) (make-vect 0.561 0.269))
    (make-segment (make-vect 0.561 0.269) (make-vect 0.561 0.279))
    (make-segment (make-vect 0.587 0.267) (make-vect 0.599 0.271))
    (make-segment (make-vect 0.599 0.271) (make-vect 0.611 0.297))
    (make-segment (make-vect 0.611 0.297) (make-vect 0.611 0.315))
    (make-segment (make-vect 0.611 0.315) (make-vect 0.621 0.323))
    (make-segment (make-vect 0.621 0.323) (make-vect 0.621 0.325))
    (make-segment (make-vect 0.587 0.267) (make-vect 0.585 0.267))
    (make-segment (make-vect 0.38 0.269) (make-vect 0.38 0.273))
    (make-segment (make-vect 0.38 0.273) (make-vect 0.378 0.275))
    (make-segment (make-vect 0.378 0.275) (make-vect 0.378 0.281))
    (make-segment (make-vect 0.378 0.281) (make-vect 0.376 0.283))
    (make-segment (make-vect 0.376 0.283) (make-vect 0.376 0.295))
    (make-segment (make-vect 0.408 0.277) (make-vect 0.4 0.281))
    (make-segment (make-vect 0.4 0.281) (make-vect 0.4 0.303))
    (make-segment (make-vect 0.4 0.303) (make-vect 0.392 0.307))
    (make-segment (make-vect 0.376 0.295) (make-vect 0.376 0.297))
    (make-segment (make-vect 0.609 0.311) (make-vect 0.597 0.319))
    (make-segment (make-vect 0.597 0.319) (make-vect 0.597 0.325))
    (make-segment (make-vect 0.637 0.311) (make-vect 0.637 0.317))
    (make-segment (make-vect 0.611 0.315) (make-vect 0.613 0.315))
    (make-segment (make-vect 0.613 0.315) (make-vect 0.613 0.317))
    (make-segment (make-vect 0.611 0.315) (make-vect 0.609 0.315))
    (make-segment (make-vect 0.609 0.315) (make-vect 0.609 0.317))
    (make-segment (make-vect 0.609 0.317) (make-vect 0.611 0.319))
    (make-segment (make-vect 0.611 0.319) (make-vect 0.613 0.319))
    (make-segment (make-vect 0.613 0.319) (make-vect 0.611 0.321))
    (make-segment (make-vect 0.611 0.321) (make-vect 0.611 0.327))
    (make-segment (make-vect 0.637 0.317) (make-vect 0.635 0.319))
    (make-segment (make-vect 0.331 0.323) (make-vect 0.327 0.34))
    (make-segment (make-vect 0.327 0.34) (make-vect 0.291 0.374))
    (make-segment (make-vect 0.291 0.374) (make-vect 0.287 0.39))
    (make-segment (make-vect 0.287 0.39) (make-vect 0.293 0.398))
    (make-segment (make-vect 0.293 0.398) (make-vect 0.295 0.416))
    (make-segment (make-vect 0.295 0.416) (make-vect 0.305 0.416))
    (make-segment (make-vect 0.305 0.416) (make-vect 0.313 0.414))
    (make-segment (make-vect 0.313 0.414) (make-vect 0.317 0.42))
    (make-segment (make-vect 0.317 0.42) (make-vect 0.317 0.432))
    (make-segment (make-vect 0.589 0.325) (make-vect 0.589 0.334))
    (make-segment (make-vect 0.589 0.334) (make-vect 0.591 0.336))
    (make-segment (make-vect 0.67 0.336) (make-vect 0.672 0.336))
    (make-segment (make-vect 0.311 0.414) (make-vect 0.315 0.406))
    (make-segment (make-vect 0.315 0.406) (make-vect 0.313 0.388))
    (make-segment (make-vect 0.313 0.388) (make-vect 0.305 0.386))
    (make-segment (make-vect 0.297 0.418) (make-vect 0.283 0.462))
    (make-segment (make-vect 0.283 0.462) (make-vect 0.283 0.573))
    (make-segment (make-vect 0.283 0.573) (make-vect 0.291 0.621))
    (make-segment (make-vect 0.291 0.621) (make-vect 0.297 0.639))
    (make-segment (make-vect 0.297 0.639) (make-vect 0.309 0.651))
    (make-segment (make-vect 0.309 0.651) (make-vect 0.307 0.661))
    (make-segment (make-vect 0.307 0.661) (make-vect 0.245 0.712))
    (make-segment (make-vect 0.245 0.712) (make-vect 0.209 0.748))
    (make-segment (make-vect 0.209 0.748) (make-vect 0.158 0.82))
    (make-segment (make-vect 0.158 0.82) (make-vect 0.132 0.843))
    (make-segment (make-vect 0.132 0.843) (make-vect 0.102 0.853))
    (make-segment (make-vect 0.102 0.853) (make-vect 0.082 0.845))
    (make-segment (make-vect 0.082 0.845) (make-vect 0.082 0.835))
    (make-segment (make-vect 0.082 0.835) (make-vect 0.136 0.804))
    (make-segment (make-vect 0.136 0.804) (make-vect 0.154 0.784))
    (make-segment (make-vect 0.68 0.426) (make-vect 0.68 0.428))
    (make-segment (make-vect 0.68 0.426) (make-vect 0.68 0.404))
    (make-segment (make-vect 0.68 0.404) (make-vect 0.682 0.402))
    (make-segment (make-vect 0.682 0.402) (make-vect 0.682 0.4))
    (make-segment (make-vect 0.682 0.4) (make-vect 0.684 0.398))
    (make-segment (make-vect 0.684 0.398) (make-vect 0.688 0.398))
    (make-segment (make-vect 0.688 0.398) (make-vect 0.69 0.4))
    (make-segment (make-vect 0.694 0.436) (make-vect 0.706 0.47))
    (make-segment (make-vect 0.706 0.47) (make-vect 0.712 0.521))
    (make-segment (make-vect 0.712 0.521) (make-vect 0.71 0.539))
    (make-segment (make-vect 0.71 0.539) (make-vect 0.708 0.591))
    (make-segment (make-vect 0.708 0.591) (make-vect 0.704 0.621))
    (make-segment (make-vect 0.704 0.621) (make-vect 0.756 0.672))
    (make-segment (make-vect 0.756 0.672) (make-vect 0.788 0.702))
    (make-segment (make-vect 0.788 0.702) (make-vect 0.796 0.706))
    (make-segment (make-vect 0.796 0.706) (make-vect 0.8 0.712))
    (make-segment (make-vect 0.694 0.436) (make-vect 0.696 0.434))
    (make-segment (make-vect 0.317 0.482) (make-vect 0.325 0.484))
    (make-segment (make-vect 0.325 0.484) (make-vect 0.323 0.513))
    (make-segment (make-vect 0.323 0.513) (make-vect 0.307 0.545))
    (make-segment (make-vect 0.317 0.482) (make-vect 0.313 0.454))
    (make-segment (make-vect 0.313 0.454) (make-vect 0.311 0.446))
    (make-segment (make-vect 0.317 0.482) (make-vect 0.313 0.484))
    (make-segment (make-vect 0.313 0.484) (make-vect 0.309 0.503))
    (make-segment (make-vect 0.309 0.503) (make-vect 0.297 0.513))
    (make-segment (make-vect 0.317 0.482) (make-vect 0.315 0.484))
    (make-segment (make-vect 0.665 0.486) (make-vect 0.678 0.517))
    (make-segment (make-vect 0.678 0.517) (make-vect 0.682 0.525))
    (make-segment (make-vect 0.682 0.525) (make-vect 0.684 0.541))
    (make-segment (make-vect 0.665 0.486) (make-vect 0.665 0.48))
    (make-segment (make-vect 0.665 0.48) (make-vect 0.668 0.478))
    (make-segment (make-vect 0.668 0.478) (make-vect 0.668 0.468))
    (make-segment (make-vect 0.668 0.468) (make-vect 0.67 0.466))
    (make-segment (make-vect 0.67 0.466) (make-vect 0.672 0.464))
    (make-segment (make-vect 0.672 0.464) (make-vect 0.672 0.46))
    (make-segment (make-vect 0.665 0.486) (make-vect 0.653 0.494))
    (make-segment (make-vect 0.653 0.494) (make-vect 0.649 0.501))
    (make-segment (make-vect 0.649 0.501) (make-vect 0.649 0.519))
    (make-segment (make-vect 0.649 0.519) (make-vect 0.663 0.557))
    (make-segment (make-vect 0.663 0.557) (make-vect 0.665 0.587))
    (make-segment (make-vect 0.71 0.585) (make-vect 0.722 0.589))
    (make-segment (make-vect 0.722 0.589) (make-vect 0.8 0.653))
    (make-segment (make-vect 0.8 0.653) (make-vect 0.806 0.657))
    (make-segment (make-vect 0.806 0.657) (make-vect 0.853 0.686))
    (make-segment (make-vect 0.853 0.686) (make-vect 0.889 0.692))
    (make-segment (make-vect 0.889 0.692) (make-vect 0.915 0.682))
    (make-segment (make-vect 0.915 0.682) (make-vect 0.947 0.684))
    (make-segment (make-vect 0.947 0.684) (make-vect 0.977 0.706))
    (make-segment (make-vect 0.977 0.706) (make-vect 1.0 0.74))
    (make-segment (make-vect 1.0 0.74) (make-vect 1.0 0.788))
    (make-segment (make-vect 1.0 0.788) (make-vect 0.985 0.816))
    (make-segment (make-vect 0.985 0.816) (make-vect 0.971 0.828))
    (make-segment (make-vect 0.971 0.828) (make-vect 0.929 0.839))
    (make-segment (make-vect 0.929 0.839) (make-vect 0.885 0.814))
    (make-segment (make-vect 0.885 0.814) (make-vect 0.841 0.766))
    (make-segment (make-vect 0.841 0.766) (make-vect 0.835 0.752))
    (make-segment (make-vect 0.71 0.585) (make-vect 0.708 0.585))
    (make-segment (make-vect 0.285 0.593) (make-vect 0.271 0.601))
    (make-segment (make-vect 0.271 0.601) (make-vect 0.203 0.653))
    (make-segment (make-vect 0.203 0.653) (make-vect 0.146 0.684))
    (make-segment (make-vect 0.146 0.684) (make-vect 0.128 0.69))
    (make-segment (make-vect 0.128 0.69) (make-vect 0.098 0.69))
    (make-segment (make-vect 0.098 0.69) (make-vect 0.094 0.68))
    (make-segment (make-vect 0.094 0.68) (make-vect 0.068 0.682))
    (make-segment (make-vect 0.068 0.682) (make-vect 0.038 0.702))
    (make-segment (make-vect 0.038 0.702) (make-vect 0.014 0.734))
    (make-segment (make-vect 0.014 0.734) (make-vect 0.002 0.768))
    (make-segment (make-vect 0.002 0.768) (make-vect 0.01 0.798))
    (make-segment (make-vect 0.01 0.798) (make-vect 0.03 0.82))
    (make-segment (make-vect 0.03 0.82) (make-vect 0.052 0.832))
    (make-segment (make-vect 0.052 0.832) (make-vect 0.076 0.837))
    (make-segment (make-vect 0.076 0.837) (make-vect 0.08 0.839))
    (make-segment (make-vect 0.706 0.625) (make-vect 0.702 0.625))
    (make-segment (make-vect 0.702 0.625) (make-vect 0.692 0.653))
    (make-segment (make-vect 0.692 0.653) (make-vect 0.655 0.696))
    (make-segment (make-vect 0.655 0.696) (make-vect 0.639 0.712))
    (make-segment (make-vect 0.639 0.712) (make-vect 0.591 0.738))
    (make-segment (make-vect 0.591 0.738) (make-vect 0.539 0.752))
    (make-segment (make-vect 0.539 0.752) (make-vect 0.436 0.752))
    (make-segment (make-vect 0.436 0.752) (make-vect 0.39 0.738))
    (make-segment (make-vect 0.39 0.738) (make-vect 0.354 0.712))
    (make-segment (make-vect 0.354 0.712) (make-vect 0.317 0.665))
    (make-segment (make-vect 0.317 0.665) (make-vect 0.309 0.659))
    (make-segment (make-vect 0.295 0.637) (make-vect 0.267 0.657))
    (make-segment (make-vect 0.267 0.657) (make-vect 0.217 0.704))
    (make-segment (make-vect 0.217 0.704) (make-vect 0.213 0.706))
    (make-segment (make-vect 0.692 0.653) (make-vect 0.768 0.714))
    (make-segment (make-vect 0.768 0.714) (make-vect 0.794 0.74))
    (make-segment (make-vect 0.794 0.74) (make-vect 0.835 0.8))
    (make-segment (make-vect 0.835 0.8) (make-vect 0.873 0.841))
    (make-segment (make-vect 0.873 0.841) (make-vect 0.893 0.853))
    (make-segment (make-vect 0.893 0.853) (make-vect 0.919 0.853))
    (make-segment (make-vect 0.919 0.853) (make-vect 0.927 0.847))
    (make-segment (make-vect 0.927 0.847) (make-vect 0.929 0.839))
    (make-segment (make-vect 0.1 0.744) (make-vect 0.096 0.76))
    (make-segment (make-vect 0.096 0.76) (make-vect 0.098 0.766))
    (make-segment (make-vect 0.1 0.744) (make-vect 0.106 0.744))
    (make-segment (make-vect 0.106 0.744) (make-vect 0.108 0.746))
    (make-segment (make-vect 0.108 0.746) (make-vect 0.11 0.746))
    (make-segment (make-vect 0.11 0.746) (make-vect 0.112 0.748))
    (make-segment (make-vect 0.112 0.748) (make-vect 0.114 0.75))
    (make-segment (make-vect 0.114 0.75) (make-vect 0.116 0.752))
    (make-segment (make-vect 0.1 0.744) (make-vect 0.08 0.744))
    (make-segment (make-vect 0.08 0.744) (make-vect 0.062 0.77))
    (make-segment (make-vect 0.885 0.746) (make-vect 0.901 0.746))
    (make-segment (make-vect 0.901 0.746) (make-vect 0.903 0.742))
    (make-segment (make-vect 0.903 0.742) (make-vect 0.923 0.744))
    (make-segment (make-vect 0.923 0.744) (make-vect 0.943 0.762))
    (make-segment (make-vect 0.943 0.762) (make-vect 0.945 0.766))
    (make-segment (make-vect 0.885 0.746) (make-vect 0.867 0.72))
    (make-segment (make-vect 0.867 0.72) (make-vect 0.853 0.706))
    (make-segment (make-vect 0.885 0.746) (make-vect 0.883 0.746))
    (make-segment (make-vect 0.883 0.746) (make-vect 0.883 0.768))
    (make-segment (make-vect 0.883 0.768) (make-vect 0.885 0.77))
    (make-segment (make-vect 0.901 0.746) (make-vect 0.911 0.762))
    (make-segment (make-vect 0.911 0.762) (make-vect 0.911 0.768))
    (make-segment (make-vect 0.901 0.746) (make-vect 0.901 0.744))
    (make-segment (make-vect 0.006 0.78) (make-vect 0.01 0.78))
    (make-segment (make-vect 0.01 0.78) (make-vect 0.01 0.776))
    (make-segment (make-vect 0.12 0.022) (make-vect 0.124 0.022))
    (make-segment (make-vect 0.124 0.022) (make-vect 0.126 0.024))
    (make-segment (make-vect 0.126 0.024) (make-vect 0.126 0.026))
    (make-segment (make-vect 0.16 0.03) (make-vect 0.162 0.032))
    (make-segment (make-vect 0.162 0.032) (make-vect 0.164 0.034))
    (make-segment (make-vect 0.171 0.088) (make-vect 0.187 0.122))
    (make-segment (make-vect 0.187 0.122) (make-vect 0.223 0.167))
    (make-segment (make-vect 0.223 0.167) (make-vect 0.233 0.175))
    (make-segment (make-vect 0.571 0.273) (make-vect 0.571 0.275))
    (make-segment (make-vect 0.571 0.275) (make-vect 0.573 0.277))
    (make-segment (make-vect 0.573 0.277) (make-vect 0.573 0.281))
    (make-segment (make-vect 0.571 0.273) (make-vect 0.573 0.273))
    (make-segment (make-vect 0.496 0.285) (make-vect 0.496 0.297))
    (make-segment (make-vect 0.496 0.297) (make-vect 0.498 0.299))
    (make-segment (make-vect 0.498 0.299) (make-vect 0.501 0.301))
    (make-segment (make-vect 0.501 0.301) (make-vect 0.503 0.301))
    (make-segment (make-vect 0.503 0.301) (make-vect 0.505 0.303))
    (make-segment (make-vect 0.505 0.303) (make-vect 0.507 0.303))
    (make-segment (make-vect 0.48 0.291) (make-vect 0.476 0.303))
    (make-segment (make-vect 0.476 0.303) (make-vect 0.468 0.305))
    (make-segment (make-vect 0.492 0.344) (make-vect 0.496 0.388))
    (make-segment (make-vect 0.496 0.388) (make-vect 0.494 0.398))
    (make-segment (make-vect 0.366 0.376) (make-vect 0.342 0.388))
    (make-segment (make-vect 0.342 0.388) (make-vect 0.329 0.406))
    (make-segment (make-vect 0.366 0.376) (make-vect 0.382 0.376))
    (make-segment (make-vect 0.382 0.376) (make-vect 0.384 0.378))
    (make-segment (make-vect 0.384 0.378) (make-vect 0.392 0.378))
    (make-segment (make-vect 0.603 0.376) (make-vect 0.631 0.378))
    (make-segment (make-vect 0.631 0.378) (make-vect 0.649 0.388))
    (make-segment (make-vect 0.649 0.388) (make-vect 0.653 0.4))
    (make-segment (make-vect 0.603 0.376) (make-vect 0.601 0.378))
    (make-segment (make-vect 0.601 0.378) (make-vect 0.597 0.378))
    (make-segment (make-vect 0.597 0.378) (make-vect 0.595 0.38))
    (make-segment (make-vect 0.595 0.38) (make-vect 0.591 0.38))
    (make-segment (make-vect 0.591 0.38) (make-vect 0.589 0.382))
    (make-segment (make-vect 0.589 0.382) (make-vect 0.585 0.382))
    (make-segment (make-vect 0.577 0.412) (make-vect 0.607 0.414))
    (make-segment (make-vect 0.607 0.414) (make-vect 0.613 0.422))
    (make-segment (make-vect 0.613 0.422) (make-vect 0.613 0.452))
    (make-segment (make-vect 0.613 0.452) (make-vect 0.603 0.47))
    (make-segment (make-vect 0.603 0.47) (make-vect 0.599 0.474))
    (make-segment (make-vect 0.599 0.474) (make-vect 0.555 0.478))
    (make-segment (make-vect 0.555 0.478) (make-vect 0.547 0.452))
    (make-segment (make-vect 0.547 0.452) (make-vect 0.549 0.426))
    (make-segment (make-vect 0.549 0.426) (make-vect 0.563 0.416))
    (make-segment (make-vect 0.563 0.416) (make-vect 0.565 0.416))
    (make-segment (make-vect 0.565 0.416) (make-vect 0.577 0.412))
    (make-segment (make-vect 0.382 0.42) (make-vect 0.374 0.438))
    (make-segment (make-vect 0.374 0.438) (make-vect 0.382 0.466))
    (make-segment (make-vect 0.382 0.466) (make-vect 0.388 0.474))
    (make-segment (make-vect 0.388 0.474) (make-vect 0.406 0.48))
    (make-segment (make-vect 0.406 0.48) (make-vect 0.44 0.48))
    (make-segment (make-vect 0.44 0.48) (make-vect 0.446 0.466))
    (make-segment (make-vect 0.446 0.466) (make-vect 0.444 0.442))
    (make-segment (make-vect 0.444 0.442) (make-vect 0.434 0.426))
    (make-segment (make-vect 0.434 0.426) (make-vect 0.406 0.42))
    (make-segment (make-vect 0.406 0.42) (make-vect 0.38 0.422))
    (make-segment (make-vect 0.513 0.422) (make-vect 0.511 0.424))
    (make-segment (make-vect 0.511 0.424) (make-vect 0.511 0.44))
    (make-segment (make-vect 0.511 0.44) (make-vect 0.509 0.442))
    (make-segment (make-vect 0.509 0.442) (make-vect 0.509 0.444))
    (make-segment (make-vect 0.509 0.444) (make-vect 0.511 0.446))
    (make-segment (make-vect 0.511 0.446) (make-vect 0.511 0.452))
    (make-segment (make-vect 0.478 0.426) (make-vect 0.484 0.454))
    (make-segment (make-vect 0.476 0.46) (make-vect 0.486 0.47))
    (make-segment (make-vect 0.486 0.47) (make-vect 0.501 0.47))
    (make-segment (make-vect 0.501 0.47) (make-vect 0.509 0.46))
    (make-segment (make-vect 0.509 0.46) (make-vect 0.513 0.46))
    (make-segment (make-vect 0.338 0.509) (make-vect 0.338 0.533))
    (make-segment (make-vect 0.338 0.533) (make-vect 0.321 0.559))
    (make-segment (make-vect 0.321 0.559) (make-vect 0.317 0.587))
    (make-segment (make-vect 0.084 0.698) (make-vect 0.068 0.72))
    (make-segment (make-vect 0.068 0.72) (make-vect 0.056 0.736))
    (make-segment (make-vect 0.056 0.736) (make-vect 0.052 0.76))
    (make-segment (make-vect 0.052 0.76) (make-vect 0.048 0.766))
    (make-segment (make-vect 0.048 0.766) (make-vect 0.05 0.768)) )) )
</file>

<file path="picture_language/pictures/colored-escher.scm">
;; From http://www.frank-buss.de/lisp/functional.html
;;
;; Modified to work with project 2
;;

(load "picture.scm") ;; make sure this works already
(load "colorpic.scm") ;; colored fish!

(define ul-fish
  (color-segments->painter
   (list
    (cons 'yellow
	  (list
	   (make-segment (make-vect 0.25 0.25) (make-vect 0.375 0))
	   (make-segment (make-vect 0 0.1875) (make-vect 0.1875 0.25))
	   (make-segment (make-vect 0.1875 0.25) (make-vect 0 0.5))
	   (make-segment (make-vect 0 0.5) (make-vect 0 0.1875))
	   (make-segment (make-vect 0.25 0.3125) (make-vect 0.4375 0.375))
	   (make-segment (make-vect 0.4375 0.375) (make-vect 0.25 0.625))
	   (make-segment (make-vect 0.25 0.625) (make-vect 0.25 0.3125))
	   (make-segment (make-vect 0.6875 0) (make-vect 0.625 0.25))
	   (make-segment (make-vect 0.625 0.25) (make-vect 0.5 0.5))
	   (make-segment (make-vect 0.5 0.5) (make-vect 0.25 0.8125))
	   (make-segment (make-vect 0.25 0.8125) (make-vect 0 1))))
    (cons 'yellow
	  (list
	   (make-segment (make-vect 0.5 0.5) (make-vect 0.75 0.5625))
	   (make-segment (make-vect 0.75 0.5625) (make-vect 1 0.5))
	   (make-segment (make-vect 0.5 0.75) (make-vect 1 0.625))
	   (make-segment (make-vect 0.5 1) (make-vect 0.75 0.75))
	   (make-segment (make-vect 0.75 0.75) (make-vect 1 0.75))))
    (cons 'blue
	  (list
	   (make-segment (make-vect 0.6875 0) (make-vect 0.875 0.125))
	   (make-segment (make-vect 0.875 0.125) (make-vect 1 0.125))
	   (make-segment (make-vect 0.625 0.25) (make-vect 0.8125 0.3125))
	   (make-segment (make-vect 0.8125 0.3125) (make-vect 1 0.25))
	   (make-segment (make-vect 0.5625 0.375) (make-vect 0.75 0.4375))
	   (make-segment (make-vect 0.75 0.4375) (make-vect 1 0.375))
	   (make-segment (make-vect 0 1) (make-vect 0.375 0.9375))
	   (make-segment (make-vect 0.375 0.9375) (make-vect 0.5 1))
	   (make-segment (make-vect 0.625 1) (make-vect 0.75 0.875))
	   (make-segment (make-vect 0.75 0.875) (make-vect 1 0.8125))
	   (make-segment (make-vect 0.75 1) (make-vect 0.8125 0.9375))
	   (make-segment (make-vect 0.8125 0.9375) (make-vect 1 0.875))
	   (make-segment (make-vect 0.875 1) (make-vect 1 0.9375)))))) )

(define ur-fish
  (color-segments->painter
   (list
    (cons 'yellow
	  (list
	   (make-segment (make-vect 0.5 0) (make-vect 0.625 0.375))
	   (make-segment (make-vect 0.625 0.375) (make-vect 0.625 0.5625))
	   (make-segment (make-vect 0.625 0) (make-vect 0.875 0.6875))
	   (make-segment (make-vect 0.75 0) (make-vect 0.8125 0.25))
	   (make-segment (make-vect 0.8125 0.25) (make-vect 1 0.5))))
    (cons 'blue
	  (list
	   (make-segment (make-vect 0.125 0) (make-vect 0.25 0.3125))
	   (make-segment (make-vect 0.25 0.3125) (make-vect 0.25 0.4375))
	   (make-segment (make-vect 0.25 0) (make-vect 0.375 0.3125))
	   (make-segment (make-vect 0.375 0.3125) (make-vect 0.375 0.4375))
	   (make-segment (make-vect 0.375 0) (make-vect 0.5 0.3125))
	   (make-segment (make-vect 0.5 0.3125) (make-vect 0.5 0.5))
	   (make-segment (make-vect 1 0.5) (make-vect 0.9375 0.625))
	   (make-segment (make-vect 0.9375 0.625) (make-vect 1 1))
	   (make-segment (make-vect 0.125 1) (make-vect 0.1875 0.8125))
	   (make-segment (make-vect 0.25 1) (make-vect 0.3125 0.875))
	   (make-segment (make-vect 0.375 1) (make-vect 0.4375 0.9375))
	   (make-segment (make-vect 0.8125 0) (make-vect 1 0.375))
	   (make-segment (make-vect 0.875 0) (make-vect 1 0.25))
	   (make-segment (make-vect 0.9375 0) (make-vect 1 0.125))))
    (cons 'yellow
	  (list	       	   	   
	   (make-segment (make-vect 1 1) (make-vect 0.75 0.625))
	   (make-segment (make-vect 0.75 0.625) (make-vect 0.375 0.4375))
	   (make-segment (make-vect 0.375 0.4375) (make-vect 0.25 0.4375))
	   (make-segment (make-vect 0.25 0.4375) (make-vect 0 0.5))
	   (make-segment (make-vect 0 0.625) (make-vect 0.4375 0.6875))
	   (make-segment (make-vect 0.5625 0.75) (make-vect 0.625 0.625))
	   (make-segment (make-vect 0.625 0.625) (make-vect 0.75 0.75))
	   (make-segment (make-vect 0.75 0.75) (make-vect 0.5625 0.75))
	   (make-segment (make-vect 0.5 0.9375) (make-vect 0.5625 0.8125))
	   (make-segment (make-vect 0.5625 0.8125) (make-vect 0.6875 0.9375))
	   (make-segment (make-vect 0.6875 0.9375) (make-vect 0.5 0.9375))
	   (make-segment (make-vect 0 0.75) (make-vect 0.1875 0.8125))
	   (make-segment (make-vect 0.1875 0.8125) (make-vect 0.4375 0.9375))
	   (make-segment (make-vect 0.4375 0.9375) (make-vect 0.5 1)))) )) )

(define bl-fish
  (color-segments->painter
   (list
    (cons 'blue
	  (list
	   (make-segment (make-vect 0 0.75) (make-vect 0.0625 0.875))
	   (make-segment (make-vect 0 0.5) (make-vect 0.125 0.75))
	   (make-segment (make-vect 0 0.25) (make-vect 0.3125 0.625))
	   (make-segment (make-vect 0 0) (make-vect 0.5 0.5))
	   (make-segment (make-vect 0.0625 0.0625) (make-vect 0.25 0))
	   (make-segment (make-vect 0.125 0.125) (make-vect 0.5 0))
	   (make-segment (make-vect 0.1875 0.1875) (make-vect 0.5 0.125))
	   (make-segment (make-vect 0.5 0.125) (make-vect 0.75 0))
	   (make-segment (make-vect 0.3125 0.3125) (make-vect 0.75 0.1875))
	   (make-segment (make-vect 0.75 0.1875) (make-vect 1 0))
	   (make-segment (make-vect 0.75 0.75) (make-vect 1 1))
	   (make-segment (make-vect 0.8125 0.8125) (make-vect 1 0.625))
	   (make-segment (make-vect 0.875 0.875) (make-vect 1 0.75))
	   (make-segment (make-vect 0.9375 0.9375) (make-vect 1 0.875))))
    (cons 'yellow
	  (list	   
	   (make-segment (make-vect 0 1) (make-vect 0.125 0.75))
	   (make-segment (make-vect 0.125 0.75) (make-vect 0.5 0.5))
	   (make-segment (make-vect 0.5 0.5) (make-vect 0.875 0.375))
	   (make-segment (make-vect 0.875 0.375) (make-vect 1 0.25))
	   (make-segment (make-vect 0.375 1) (make-vect 0.6875 0.625))
	   (make-segment (make-vect 0.6875 0.625) (make-vect 1 0.375))
	   (make-segment (make-vect 0.6875 1) (make-vect 0.75 0.75))
	   (make-segment (make-vect 0.75 0.75) (make-vect 1 0.5)))) )))

(define br-fish
  (color-segments->painter
   (list
    (cons 'yellow
	  (list
	   (make-segment (make-vect 0 0) (make-vect 0.25 0.125))
	   (make-segment (make-vect 0.25 0.125) (make-vect 0.5 0.125))
	   (make-segment (make-vect 0.5 0.125) (make-vect 1 0))
	   (make-segment (make-vect 0 0.25) (make-vect 0.125 0.0625))
	   (make-segment (make-vect 0 0.375) (make-vect 0.4375 0.25))
	   (make-segment (make-vect 0 0.5) (make-vect 0.5 0.375))))
    (cons 'blue
	  (list
	   (make-segment (make-vect 0 0.625) (make-vect 0.4375 0.5))
	   (make-segment (make-vect 0 0.75) (make-vect 0.4375 0.625))
	   (make-segment (make-vect 0 0.875) (make-vect 0.4375 0.8125))
	   (make-segment (make-vect 0.8125 0.8125) (make-vect 1 0.875))
	   (make-segment (make-vect 0.875 0.6875) (make-vect 1 0.75))
	   (make-segment (make-vect 0.9375 0.5625) (make-vect 1 0.625))))
    (cons 'yellow
	  (list
	   (make-segment (make-vect 0.5 1) (make-vect 0.4375 0.8125))
	   (make-segment (make-vect 0.4375 0.8125) (make-vect 0.4375 0.5))
	   (make-segment (make-vect 0.4375 0.5) (make-vect 0.5 0.375))
	   (make-segment (make-vect 0.5 0.375) (make-vect 0.625 0.25))
	   (make-segment (make-vect 0.625 0.25) (make-vect 1 0))
	   (make-segment (make-vect 0.625 1) (make-vect 0.6875 0.625))
	   (make-segment (make-vect 0.625 0.375) (make-vect 0.75 0.25))
	   (make-segment (make-vect 0.75 0.25) (make-vect 0.75 0.4375))
	   (make-segment (make-vect 0.75 0.4375) (make-vect 0.625 0.375))
	   (make-segment (make-vect 0.8125 0.4375) (make-vect 0.9375 0.3125))
	   (make-segment (make-vect 0.9375 0.3125) (make-vect 0.9375 0.5))
	   (make-segment (make-vect 0.9375 0.5) (make-vect 0.8125 0.4375))
	   (make-segment (make-vect 0.75 1) (make-vect 0.8125 0.8125))
	   (make-segment (make-vect 0.8125 0.8125) (make-vect 0.9375 0.5625))
	   (make-segment (make-vect 0.9375 0.5625) (make-vect 1 0.5))))) ))


(define (quartet ul ur bl br)
  (below (beside bl br)
	 (beside ul ur)))

(define (cycle p)
  (let ((half (beside p (rotate270 p))))
    (below (rotate180 half) half)))

(define fish1 (below (beside bl-fish br-fish)
		     (beside ul-fish ur-fish)))
(define fish2 (cycle (rotate90 ur-fish)))

(define blank (segments->painter '()))
(define side1 (quartet blank blank
		       (rotate90 fish1) fish1))

(define side2 (quartet side1 side1 (rotate90 fish1) fish1))

(define corner1 (quartet blank blank blank fish2))

(define corner2 (quartet corner1 side1 (rotate90 side1) fish2))

(define corner3 (quartet corner2 side2 (rotate90 side2) (rotate90 fish1)))

(define escher-fish (cycle corner3))  

(define (draw-escher-fish)
  (escher-fish (make-frame (make-vect -0.8 -0.8)
			   (make-vect 2.6 0)
			   (make-vect 0 2.6))))



;; Used to transform the segment lists on the site
;; to fit our data abstraction.
;; should also deep-map (lambda (x) (/ x 16))
;; to put the coordinates in the unit square

(define (respect-abstraction seg-list)
  (cons 'list
	(map (lambda (seg)
	       (cons 'make-segment
		     (map (lambda (pt)
			    (cons 'make-vect pt))
			  seg)))
	     seg-list)))
</file>

<file path="picture_language/pictures/colorpic.scm">
;; color-segments-list is an association list of the form
;; ((color seg seg seg ...) (color seg seg seg ...) ... )
(define (color-segments->painter color-segments-list)
  (lambda (frame)
    (for-each
     (lambda (color-segments)
       (let ((color (car color-segments))
	     (segments (cdr color-segments)))
	 (for-each
	  (lambda (segment)
	    (draw-colored-line
	     color
	     ((frame-coord-map frame) (start-segment segment))
	     ((frame-coord-map frame) (end-segment segment))))
	  segments)))
     color-segments-list)))

;; c is the name of the color:
;; 0 black
;; 1 blue
;; 2 green
;; 3 cyan
;; 4 red
;; 5 purple
;; 6 yellow
;; 7 white
(define (draw-colored-line c v1 v2)  
  (setpc (cdr (assoc c
		     '((black . 0)
		       (blue . 1)
		       (green . 2)
		       (cyan . 3)
		       (red . 4)
		       (purple . 5)
		       (yellow . 6)
		       (white . 7)))))
  (draw-line v1 v2)
  (setpc 7))
(define (draw-line v1 v2)
  (penup)
  (setxy (- (* (xcor-vect v1) 200) 100)
	 (- (* (ycor-vect v1) 200) 100))
  (pendown)
  (setxy (- (* (xcor-vect v2) 200) 100)
	 (- (* (ycor-vect v2) 200) 100)))
</file>

<file path="picture_language/pictures/escher.scm">
;; From http://www.frank-buss.de/lisp/functional.html
;;
;; Modified to work with project 2
;;

(load "picture.scm") ;; make sure this works already

(define ul-fish
  (segments->painter
   (list (make-segment (make-vect 0.25 0.25) (make-vect 0.375 0))
	 (make-segment (make-vect 0 0.1875) (make-vect 0.1875 0.25))
	 (make-segment (make-vect 0.1875 0.25) (make-vect 0 0.5))
	 (make-segment (make-vect 0 0.5) (make-vect 0 0.1875))
	 (make-segment (make-vect 0.25 0.3125) (make-vect 0.4375 0.375))
	 (make-segment (make-vect 0.4375 0.375) (make-vect 0.25 0.625))
	 (make-segment (make-vect 0.25 0.625) (make-vect 0.25 0.3125))
	 (make-segment (make-vect 0.6875 0) (make-vect 0.625 0.25))
	 (make-segment (make-vect 0.625 0.25) (make-vect 0.5 0.5))
	 (make-segment (make-vect 0.5 0.5) (make-vect 0.25 0.8125))
	 (make-segment (make-vect 0.25 0.8125) (make-vect 0 1))
	 (make-segment (make-vect 0.6875 0) (make-vect 0.875 0.125))
	 (make-segment (make-vect 0.875 0.125) (make-vect 1 0.125))
	 (make-segment (make-vect 0.625 0.25) (make-vect 0.8125 0.3125))
	 (make-segment (make-vect 0.8125 0.3125) (make-vect 1 0.25))
	 (make-segment (make-vect 0.5625 0.375) (make-vect 0.75 0.4375))
	 (make-segment (make-vect 0.75 0.4375) (make-vect 1 0.375))
	 (make-segment (make-vect 0.5 0.5) (make-vect 0.75 0.5625))
	 (make-segment (make-vect 0.75 0.5625) (make-vect 1 0.5))
	 (make-segment (make-vect 0.5 0.75) (make-vect 1 0.625))
	 (make-segment (make-vect 0 1) (make-vect 0.375 0.9375))
	 (make-segment (make-vect 0.375 0.9375) (make-vect 0.5 1))
	 (make-segment (make-vect 0.5 1) (make-vect 0.75 0.75))
	 (make-segment (make-vect 0.75 0.75) (make-vect 1 0.75))
	 (make-segment (make-vect 0.625 1) (make-vect 0.75 0.875))
	 (make-segment (make-vect 0.75 0.875) (make-vect 1 0.8125))
	 (make-segment (make-vect 0.75 1) (make-vect 0.8125 0.9375))
	 (make-segment (make-vect 0.8125 0.9375) (make-vect 1 0.875))
	 (make-segment (make-vect 0.875 1) (make-vect 1 0.9375)))) )

(define ur-fish
  (segments->painter
   (list (make-segment (make-vect 0.125 0) (make-vect 0.25 0.3125))
      (make-segment (make-vect 0.25 0.3125) (make-vect 0.25 0.4375))
      (make-segment (make-vect 0.25 0) (make-vect 0.375 0.3125))
      (make-segment (make-vect 0.375 0.3125) (make-vect 0.375 0.4375))
      (make-segment (make-vect 0.375 0) (make-vect 0.5 0.3125))
      (make-segment (make-vect 0.5 0.3125) (make-vect 0.5 0.5))
      (make-segment (make-vect 0.5 0) (make-vect 0.625 0.375))
      (make-segment (make-vect 0.625 0.375) (make-vect 0.625 0.5625))
      (make-segment (make-vect 0.625 0) (make-vect 0.875 0.6875))
      (make-segment (make-vect 0.75 0) (make-vect 0.8125 0.25))
      (make-segment (make-vect 0.8125 0.25) (make-vect 1 0.5))
      (make-segment (make-vect 1 0.5) (make-vect 0.9375 0.625))
      (make-segment (make-vect 0.9375 0.625) (make-vect 1 1))
      (make-segment (make-vect 1 1) (make-vect 0.75 0.625))
      (make-segment (make-vect 0.75 0.625) (make-vect 0.375 0.4375))
      (make-segment (make-vect 0.375 0.4375) (make-vect 0.25 0.4375))
      (make-segment (make-vect 0.25 0.4375) (make-vect 0 0.5))
      (make-segment (make-vect 0.8125 0) (make-vect 1 0.375))
      (make-segment (make-vect 0.875 0) (make-vect 1 0.25))
      (make-segment (make-vect 0.9375 0) (make-vect 1 0.125))
      (make-segment (make-vect 0 0.625) (make-vect 0.4375 0.6875))
      (make-segment (make-vect 0.5625 0.75) (make-vect 0.625 0.625))
      (make-segment (make-vect 0.625 0.625) (make-vect 0.75 0.75))
      (make-segment (make-vect 0.75 0.75) (make-vect 0.5625 0.75))
      (make-segment (make-vect 0.5 0.9375) (make-vect 0.5625 0.8125))
      (make-segment (make-vect 0.5625 0.8125) (make-vect 0.6875 0.9375))
      (make-segment (make-vect 0.6875 0.9375) (make-vect 0.5 0.9375))
      (make-segment (make-vect 0 0.75) (make-vect 0.1875 0.8125))
      (make-segment (make-vect 0.1875 0.8125) (make-vect 0.4375 0.9375))
      (make-segment (make-vect 0.4375 0.9375) (make-vect 0.5 1))
      (make-segment (make-vect 0.125 1) (make-vect 0.1875 0.8125))
      (make-segment (make-vect 0.25 1) (make-vect 0.3125 0.875))
      (make-segment (make-vect 0.375 1) (make-vect 0.4375 0.9375))) ))

(define bl-fish
  (segments->painter
   (list (make-segment (make-vect 0 0.75) (make-vect 0.0625 0.875))
      (make-segment (make-vect 0 0.5) (make-vect 0.125 0.75))
      (make-segment (make-vect 0 0.25) (make-vect 0.3125 0.625))
      (make-segment (make-vect 0 0) (make-vect 0.5 0.5))
      (make-segment (make-vect 0.0625 0.0625) (make-vect 0.25 0))
      (make-segment (make-vect 0.125 0.125) (make-vect 0.5 0))
      (make-segment (make-vect 0.1875 0.1875) (make-vect 0.5 0.125))
      (make-segment (make-vect 0.5 0.125) (make-vect 0.75 0))
      (make-segment (make-vect 0.3125 0.3125) (make-vect 0.75 0.1875))
      (make-segment (make-vect 0.75 0.1875) (make-vect 1 0))
      (make-segment (make-vect 0 1) (make-vect 0.125 0.75))
      (make-segment (make-vect 0.125 0.75) (make-vect 0.5 0.5))
      (make-segment (make-vect 0.5 0.5) (make-vect 0.875 0.375))
      (make-segment (make-vect 0.875 0.375) (make-vect 1 0.25))
      (make-segment (make-vect 0.375 1) (make-vect 0.6875 0.625))
      (make-segment (make-vect 0.6875 0.625) (make-vect 1 0.375))
      (make-segment (make-vect 0.6875 1) (make-vect 0.75 0.75))
      (make-segment (make-vect 0.75 0.75) (make-vect 1 0.5))
      (make-segment (make-vect 0.75 0.75) (make-vect 1 1))
      (make-segment (make-vect 0.8125 0.8125) (make-vect 1 0.625))
      (make-segment (make-vect 0.875 0.875) (make-vect 1 0.75))
      (make-segment (make-vect 0.9375 0.9375) (make-vect 1 0.875))) ))

(define br-fish
  (segments->painter
   (list (make-segment (make-vect 0 0) (make-vect 0.25 0.125))
      (make-segment (make-vect 0.25 0.125) (make-vect 0.5 0.125))
      (make-segment (make-vect 0.5 0.125) (make-vect 1 0))
      (make-segment (make-vect 0 0.25) (make-vect 0.125 0.0625))
      (make-segment (make-vect 0 0.375) (make-vect 0.4375 0.25))
      (make-segment (make-vect 0 0.5) (make-vect 0.5 0.375))
      (make-segment (make-vect 0 0.625) (make-vect 0.4375 0.5))
      (make-segment (make-vect 0 0.75) (make-vect 0.4375 0.625))
      (make-segment (make-vect 0 0.875) (make-vect 0.4375 0.8125))
      (make-segment (make-vect 0.5 1) (make-vect 0.4375 0.8125))
      (make-segment (make-vect 0.4375 0.8125) (make-vect 0.4375 0.5))
      (make-segment (make-vect 0.4375 0.5) (make-vect 0.5 0.375))
      (make-segment (make-vect 0.5 0.375) (make-vect 0.625 0.25))
      (make-segment (make-vect 0.625 0.25) (make-vect 1 0))
      (make-segment (make-vect 0.625 1) (make-vect 0.6875 0.625))
      (make-segment (make-vect 0.625 0.375) (make-vect 0.75 0.25))
      (make-segment (make-vect 0.75 0.25) (make-vect 0.75 0.4375))
      (make-segment (make-vect 0.75 0.4375) (make-vect 0.625 0.375))
      (make-segment (make-vect 0.8125 0.4375) (make-vect 0.9375 0.3125))
      (make-segment (make-vect 0.9375 0.3125) (make-vect 0.9375 0.5))
      (make-segment (make-vect 0.9375 0.5) (make-vect 0.8125 0.4375))
      (make-segment (make-vect 0.75 1) (make-vect 0.8125 0.8125))
      (make-segment (make-vect 0.8125 0.8125) (make-vect 0.9375 0.5625))
      (make-segment (make-vect 0.9375 0.5625) (make-vect 1 0.5))
      (make-segment (make-vect 0.8125 0.8125) (make-vect 1 0.875))
      (make-segment (make-vect 0.875 0.6875) (make-vect 1 0.75))
      (make-segment (make-vect 0.9375 0.5625) (make-vect 1 0.625))) ))



(define (quartet ul ur bl br)
  (below (beside bl br)
	 (beside ul ur)))

(define (cycle p)
  (let ((half (beside p (rotate270 p))))
    (below (rotate180 half) half)))

(define fish1 (below (beside bl-fish br-fish)
		     (beside ul-fish ur-fish)))
(define fish2 (cycle (rotate90 ur-fish)))

(define blank (segments->painter '()))
(define side1 (quartet blank blank
		       (rotate90 fish1) fish1))

(define side2 (quartet side1 side1 (rotate90 fish1) fish1))

(define corner1 (quartet blank blank blank fish2))

(define corner2 (quartet corner1 side1 (rotate90 side1) fish2))

(define corner3 (quartet corner2 side2 (rotate90 side2) (rotate90 fish1)))

(define escher-fish (cycle corner3))  

(define (draw-escher-fish)
  (escher-fish (make-frame (make-vect -0.8 -0.8)
			   (make-vect 2.6 0)
			   (make-vect 0 2.6))))
  





;; Used to transform the segment lists on the site
;; to fit our data abstraction.
;; should also deep-map (lambda (x) (/ x 16))
;; to put the coordinates in the unit square

(define (respect-abstraction seg-list)
  (cons 'list
	(map (lambda (seg)
	       (cons 'make-segment
		     (map (lambda (pt)
			    (cons 'make-vect pt))
			  seg)))
	     seg-list)))
</file>

<file path="picture_language/pictures/shapes.scm">
;; Raymond Williams

;; The shapes:
;; p_trianagle
;; p_triangle_dn
;; p_star
;; p_star2    ;; not as nice as p_star, but splits better
;; p_octo
;; p_octo_full


(define p_triangle
  (segments->painter
   (list (make-segment (make-vect 0.5 1.0) (make-vect 1.0 0.0))
         (make-segment (make-vect 0.5 1.0) (make-vect 0.0 0.0))
         (make-segment (make-vect 0.0 0.0) (make-vect 1.0 0.0)))))
(define p_triangle_dn
  (segments->painter
   (list (make-segment (make-vect 0.5 0.0) (make-vect 0.0 1.0))
         (make-segment (make-vect 0.5 0.0) (make-vect 1.0 1.0))
         (make-segment (make-vect 0.0 1.0) (make-vect 1.0 1.0)))))

(define p_star
  (segments->painter
   (list (make-segment (make-vect 0.5 1.00) (make-vect 0.1 0.00))
         (make-segment (make-vect 0.5 1.00) (make-vect 0.9 0.00))
         (make-segment (make-vect 0.0 0.65) (make-vect 1.0 0.65))
         (make-segment (make-vect 0.0 0.65) (make-vect 0.9 0.00))
         (make-segment (make-vect 0.1 0.00) (make-vect 1.0 0.65)))))


;Star2 is not as nice as star, but it splits better.
(define p_star2
  (segments->painter
   (list (make-segment (make-vect 0.5 1.0) (make-vect 0.0 0.0))
         (make-segment (make-vect 0.5 1.0) (make-vect 1.0 0.0))
         (make-segment (make-vect 0.0 0.7) (make-vect 1.0 0.7))
         (make-segment (make-vect 0.0 0.7) (make-vect 1.0 0.0))
         (make-segment (make-vect 0.0 0.0) (make-vect 1.0 0.7)))))

(define p_octo
  (segments->painter
   (list (make-segment (make-vect 0.00 0.33) (make-vect 0.00 0.66))
         (make-segment (make-vect 0.00 0.66) (make-vect 0.33 1.00))
         (make-segment (make-vect 0.33 1.00) (make-vect 0.66 1.00))
         (make-segment (make-vect 0.66 1.00) (make-vect 1.00 0.66))
         (make-segment (make-vect 1.00 0.66) (make-vect 1.00 0.33))
         (make-segment (make-vect 1.00 0.33) (make-vect 0.66 0.00))
         (make-segment (make-vect 0.66 0.00) (make-vect 0.33 0.00))
         (make-segment (make-vect 0.33 0.00) (make-vect 0.00 0.33)))))

(define p_octo_full
  (segments->painter
   (list (make-segment (make-vect 0.00 0.33) (make-vect 0.00 0.66))
         (make-segment (make-vect 0.00 0.33) (make-vect 0.33 1.00))
         (make-segment (make-vect 0.00 0.33) (make-vect 0.66 1.00))
         (make-segment (make-vect 0.00 0.33) (make-vect 1.00 0.66))
         (make-segment (make-vect 0.00 0.33) (make-vect 1.00 0.33))
         (make-segment (make-vect 0.00 0.33) (make-vect 0.66 0.00))
         (make-segment (make-vect 0.00 0.33) (make-vect 0.33 0.00))
         (make-segment (make-vect 0.00 0.66) (make-vect 0.00 0.33))
         (make-segment (make-vect 0.00 0.66) (make-vect 0.33 1.00))
         (make-segment (make-vect 0.00 0.66) (make-vect 0.66 1.00))
         (make-segment (make-vect 0.00 0.66) (make-vect 1.00 0.66))
         (make-segment (make-vect 0.00 0.66) (make-vect 1.00 0.33))
         (make-segment (make-vect 0.00 0.66) (make-vect 0.66 0.00))
         (make-segment (make-vect 0.00 0.66) (make-vect 0.33 0.00))
         (make-segment (make-vect 0.33 1.00) (make-vect 0.00 0.33))
         (make-segment (make-vect 0.33 1.00) (make-vect 0.00 0.66))
         (make-segment (make-vect 0.33 1.00) (make-vect 0.66 1.00))
         (make-segment (make-vect 0.33 1.00) (make-vect 1.00 0.66))
         (make-segment (make-vect 0.33 1.00) (make-vect 1.00 0.33))
         (make-segment (make-vect 0.33 1.00) (make-vect 0.66 0.00))
         (make-segment (make-vect 0.33 1.00) (make-vect 0.33 0.00))
         (make-segment (make-vect 0.66 1.00) (make-vect 0.00 0.33))
         (make-segment (make-vect 0.66 1.00) (make-vect 0.00 0.66))
         (make-segment (make-vect 0.66 1.00) (make-vect 0.33 1.00))
         (make-segment (make-vect 0.66 1.00) (make-vect 1.00 0.66))
         (make-segment (make-vect 0.66 1.00) (make-vect 1.00 0.33))
         (make-segment (make-vect 0.66 1.00) (make-vect 0.66 0.00))
         (make-segment (make-vect 0.66 1.00) (make-vect 0.33 0.00))
         (make-segment (make-vect 1.00 0.66) (make-vect 0.00 0.33))
         (make-segment (make-vect 1.00 0.66) (make-vect 0.00 0.66))
         (make-segment (make-vect 1.00 0.66) (make-vect 0.33 1.00))
         (make-segment (make-vect 1.00 0.66) (make-vect 0.66 1.00))
         (make-segment (make-vect 1.00 0.66) (make-vect 1.00 0.33))
         (make-segment (make-vect 1.00 0.66) (make-vect 0.66 0.00))
         (make-segment (make-vect 1.00 0.66) (make-vect 0.33 0.00))
         (make-segment (make-vect 1.00 0.33) (make-vect 0.00 0.33))
	 (make-segment (make-vect 1.00 0.33) (make-vect 0.00 0.66))
         (make-segment (make-vect 1.00 0.33) (make-vect 0.33 1.00))
         (make-segment (make-vect 1.00 0.33) (make-vect 0.66 1.00))
         (make-segment (make-vect 1.00 0.33) (make-vect 1.00 0.66))
         (make-segment (make-vect 1.00 0.33) (make-vect 0.66 0.00))
         (make-segment (make-vect 1.00 0.33) (make-vect 0.33 0.00))
         (make-segment (make-vect 0.66 0.00) (make-vect 0.00 0.33))
         (make-segment (make-vect 0.66 0.00) (make-vect 0.00 0.66))
         (make-segment (make-vect 0.66 0.00) (make-vect 0.33 1.00))
         (make-segment (make-vect 0.66 0.00) (make-vect 0.66 1.00))
         (make-segment (make-vect 0.66 0.00) (make-vect 1.00 0.66))
         (make-segment (make-vect 0.66 0.00) (make-vect 1.00 0.33))
         (make-segment (make-vect 0.66 0.00) (make-vect 0.33 0.00))
         (make-segment (make-vect 0.33 0.00) (make-vect 0.00 0.33))
         (make-segment (make-vect 0.33 0.00) (make-vect 0.00 0.66))
         (make-segment (make-vect 0.33 0.00) (make-vect 0.33 1.00))
         (make-segment (make-vect 0.33 0.00) (make-vect 0.66 1.00))
         (make-segment (make-vect 0.33 0.00) (make-vect 1.00 0.66))
         (make-segment (make-vect 0.33 0.00) (make-vect 1.00 0.33))
         (make-segment (make-vect 0.33 0.00) (make-vect 0.66 0.00)))))
</file>

<file path="picture_language/2.44.scm">
(define (up-split painter n)
  (if (= n 0)
    painter
    (let ((smaller (up-split painter (- n 1))))
      (below painter (beside smaller smaller)))))
</file>

<file path="picture_language/2.45.scm">
(define (split outer inner)
  (define (newsplit painter n)
    (if (= n 0)
      painter
      (let ((smaller (newsplit painter (- n 1))))
        (outer painter (inner smaller smaller)))))
  newsplit)

(define right-split (split beside below))
(define up-split (split below beside))
</file>

<file path="picture_language/2.46.scm">
(define (make-vect x y) (list x y))
(define (xcor-vect vect) (car vect))
(define (ycor-vect vect) (cadr vect))

(define (add-vect v1 v2)
  (make-vect
    (+ (xcor-vect v1) (xcor-vect v2))
    (+ (ycor-vect v1) (ycor-vect v2))))

(define (sub-vect v1 v2)
  (make-vect
    (- (xcor-vect v1) (xcor-vect v2))
    (- (ycor-vect v1) (ycor-vect v2))))

(define (scale-vect scal vect)
  (make-vect
    (* scal (xcor-vect vect))
    (* scal (ycor-vect vect))))
</file>

<file path="picture_language/2.47.scm">
(define (make-frame origin edge1 edge2) 
  (list origin edge1 edge2))

(define (origin-frame frame) (car frame))
(define (edge1-frame frame) (cadr frame))
(define (edge2-frame frame) (caddr frame))

;(define (make-frame origin edge1 edge2)
  ;(cons origin (cons edge1 edge2)))

;(define (origin-frame frame) (car frame))
;(define (edge1-frame frame) (cadr frame))
;(define (edge2-frame frame) (cddr frame))
</file>

<file path="picture_language/2.48.scm">
(define (make-segment start-vector end-vector)
  (list start-vector end-vector))

(define (start-segment segment) (car segment))

(define (end-segment segment) (cadr segment))
</file>

<file path="picture_language/2.49.scm">
(load "vect")
(load "segment")
(load "frame")
(load "picture")

(define outline
  (segments->painter
    (list
      (make-segment (make-vect 0 0) (make-vect 1 0))
      (make-segment (make-vect 1 0) (make-vect 1 1))
      (make-segment (make-vect 1 1) (make-vect 0 1))
      (make-segment (make-vect 0 1) (make-vect 0 0)))))

(define cross
  (segments->painter
    (list
      (make-segment (make-vect 0 0) (make-vect 1 1))
      (make-segment (make-vect 0 1) (make-vect 1 0)))))

(define diamond
  (segments->painter
    (list
      (make-segment (make-vect 0.5 0) (make-vect 1 0.5))
      (make-segment (make-vect 1 0.5) (make-vect 0.5 1))
      (make-segment (make-vect 0.5 1) (make-vect 0 0.5))
      (make-segment (make-vect 0 0.5) (make-vect 0.5 0)))))

(define wave
  (segments->painter
    (list
      (make-segment (make-vect 0.354 1.000) (make-vect 0.284 0.876))
      (make-segment (make-vect 0.284 0.876) (make-vect 0.367 0.700))
      (make-segment (make-vect 0.367 0.700) (make-vect 0.279 0.700))
      (make-segment (make-vect 0.279 0.700) (make-vect 0.114 0.654))
      (make-segment (make-vect 0.114 0.654) (make-vect 0.000 0.828))
      (make-segment (make-vect 0.000 0.705) (make-vect 0.118 0.520))
      (make-segment (make-vect 0.118 0.520) (make-vect 0.273 0.627))
      (make-segment (make-vect 0.273 0.627) (make-vect 0.325 0.575))
      (make-segment (make-vect 0.325 0.575) (make-vect 0.232 0.000))
      (make-segment (make-vect 0.388 0.000) (make-vect 0.453 0.336))
      (make-segment (make-vect 0.453 0.336) (make-vect 0.576 0.000))
      (make-segment (make-vect 0.710 0.000) (make-vect 0.533 0.461))
      (make-segment (make-vect 0.533 0.461) (make-vect 1.000 0.260))
      (make-segment (make-vect 1.000 0.393) (make-vect 0.611 0.695))
      (make-segment (make-vect 0.611 0.695) (make-vect 0.535 0.695))
      (make-segment (make-vect 0.535 0.695) (make-vect 0.586 0.875))
      (make-segment (make-vect 0.586 0.875) (make-vect 0.507 1.000)))))
</file>

<file path="picture_language/2.50.scm">
(define (flip-horiz painter)
  (transform-painter painter
                     (make-vect 1 0)
                     (make-vect 0 0)
                     (make-vect 1 1)))

(define (rotate180 painter)
  (transform-painter painter
                     (make-vect 1 1)
                     (make-vect 0 1)
                     (make-vect 1 0)))

(define (rotate270 painter)
  (transform-painter painter
                     (make-vect 0 1)
                     (make-vect 0 0)
                     (make-vect 1 1)))
</file>

<file path="picture_language/2.51.scm">
(define (below painter1 painter2)
  (let ((paint-bottom (transform-painter painter1
                                         (make-vect 0 0)
                                         (make-vect 1 0)
                                         (make-vect 0 0.5)))
        (paint-up (transform-painter painter2
                                     (make-vect 0 0.5)
                                     (make-vect 1 0.5)
                                     (make-vect 0 1))))
    (lambda (frame)
      (paint-bottom frame)
      (paint-up frame))))

(define (below2 painter1 painter2)
  (rotate90 (beside (rotate270 painter1) (rotate270 painter2))))
</file>

<file path="picture_language/2.52.scm">
(load "vect")
(load "segment")
(load "frame")
(load "picture")

(define wave
  (segments->painter
    (list
      (make-segment (make-vect 0.354 1.000) (make-vect 0.284 0.876))
      (make-segment (make-vect 0.284 0.876) (make-vect 0.367 0.700))
      (make-segment (make-vect 0.367 0.700) (make-vect 0.279 0.700))
      (make-segment (make-vect 0.279 0.700) (make-vect 0.114 0.654))
      (make-segment (make-vect 0.114 0.654) (make-vect 0.000 0.828))
      (make-segment (make-vect 0.000 0.705) (make-vect 0.118 0.520))
      (make-segment (make-vect 0.118 0.520) (make-vect 0.273 0.627))
      (make-segment (make-vect 0.273 0.627) (make-vect 0.325 0.575))
      (make-segment (make-vect 0.325 0.575) (make-vect 0.232 0.000))
      (make-segment (make-vect 0.388 0.000) (make-vect 0.453 0.336))
      (make-segment (make-vect 0.453 0.336) (make-vect 0.576 0.000))
      (make-segment (make-vect 0.710 0.000) (make-vect 0.533 0.461))
      (make-segment (make-vect 0.533 0.461) (make-vect 1.000 0.260))
      (make-segment (make-vect 1.000 0.393) (make-vect 0.611 0.695))
      (make-segment (make-vect 0.611 0.695) (make-vect 0.535 0.695))
      (make-segment (make-vect 0.535 0.695) (make-vect 0.586 0.875))
      (make-segment (make-vect 0.586 0.875) (make-vect 0.507 1.000))
      (make-segment (make-vect 0.370 0.897) (make-vect 0.400 0.897))
      (make-segment (make-vect 0.465 0.897) (make-vect 0.495 0.897))
      (make-segment (make-vect 0.440 0.840) (make-vect 0.440 0.810))
      (make-segment (make-vect 0.386 0.747) (make-vect 0.449 0.717))
      (make-segment (make-vect 0.449 0.717) (make-vect 0.502 0.750)))))

(define (corner-split painter n)
  (if (= n 0)
      painter
      (beside
        (below painter painter)
        (below painter (corner-split painter (- n 1))))))

(define (square-limit painter n)
  (let ((quarter (corner-split (flip-horiz painter) n)))
    (let ((half (beside (flip-horiz quarter) quarter)))
      (below (flip-vert half) half))))
</file>

<file path="picture_language/below.scm">
2.51.scm
</file>

<file path="picture_language/frame.scm">
2.47.scm
</file>

<file path="picture_language/painter-transforms.scm">
2.50.scm
</file>

<file path="picture_language/painters.scm">
2.49.scm
</file>

<file path="picture_language/picture.scm">
;; Code for CS61A project 2 -- picture language

(define (flipped-pairs painter)
  (let ((painter2 (beside painter (flip-vert painter))))
    (below painter2 painter2)))

(define (right-split painter n)
  (if (= n 0)
      painter
      (let ((smaller (right-split painter (- n 1))))
	(beside painter (below smaller smaller)))))

(define (corner-split painter n)
  (if (= n 0)
      painter
      (let ((up (up-split painter (- n 1)))
	    (right (right-split painter (- n 1))))
	(let ((top-left (beside up up))
	      (bottom-right (below right right))
	      (corner (corner-split painter (- n 1))))
	  (beside (below painter top-left)
		  (below bottom-right corner))))))

(define (square-limit painter n)
  (let ((quarter (corner-split painter n)))
    (let ((half (beside (flip-horiz quarter) quarter)))
      (below (flip-vert half) half))))

(define (square-of-four tl tr bl br)
  (lambda (painter)
    (let ((top (beside (tl painter) (tr painter)))
	  (bottom (beside (bl painter) (br painter))))
      (below bottom top))))

(define (identity x) x)

(define (flipped-pairs painter)
  (let ((combine4 (square-of-four identity flip-vert
				  identity flip-vert)))
    (combine4 painter)))

;; or

; (define flipped-pairs
;   (square-of-four identity flip-vert identity flip-vert))

(define (square-limit painter n)
  (let ((combine4 (square-of-four flip-horiz identity
				  rotate180 flip-vert)))
    (combine4 (corner-split painter n))))

(define (frame-coord-map frame)
  (lambda (v)
    (add-vect
     (origin-frame frame)
     (add-vect (scale-vect (xcor-vect v)
			   (edge1-frame frame))
	       (scale-vect (ycor-vect v)
			   (edge2-frame frame))))))

(define (segments->painter segment-list)
  (lambda (frame)
    (for-each
     (lambda (segment)
       (draw-line
	((frame-coord-map frame) (start-segment segment))
	((frame-coord-map frame) (end-segment segment))))
     segment-list)))

(define (draw-line v1 v2)
  (penup)
  (setxy (- (* (xcor-vect v1) 200) 100)
	 (- (* (ycor-vect v1) 200) 100))
  (pendown)
  (setxy (- (* (xcor-vect v2) 200) 100)
	 (- (* (ycor-vect v2) 200) 100)))

(define (transform-painter painter origin corner1 corner2)
  (lambda (frame)
    (let ((m (frame-coord-map frame)))
      (let ((new-origin (m origin)))
	(painter
	 (make-frame new-origin
		     (sub-vect (m corner1) new-origin)
		     (sub-vect (m corner2) new-origin)))))))

(define (flip-vert painter)
  (transform-painter painter
		     (make-vect 0.0 1.0)
		     (make-vect 1.0 1.0)
		     (make-vect 0.0 0.0)))

(define (shrink-to-upper-right painter)
  (transform-painter painter
		    (make-vect 0.5 0.5)
		    (make-vect 1.0 0.5)
		    (make-vect 0.5 1.0)))

(define (rotate90 painter)
  (transform-painter painter
		     (make-vect 1.0 0.0)
		     (make-vect 1.0 1.0)
		     (make-vect 0.0 0.0)))

(define (squash-inwards painter)
  (transform-painter painter
		     (make-vect 0.0 0.0)
		     (make-vect 0.65 0.35)
		     (make-vect 0.35 0.65)))

(define (beside painter1 painter2)
  (let ((split-point (make-vect 0.5 0.0)))
    (let ((paint-left
	   (transform-painter painter1
			      (make-vect 0.0 0.0)
			      split-point
			      (make-vect 0.0 1.0)))
	  (paint-right
	   (transform-painter painter2
			      split-point
			      (make-vect 1.0 0.0)
			      (make-vect 0.5 1.0))))
      (lambda (frame)
	(paint-left frame)
	(paint-right frame)))))

;;
;; Your code goes here
;;

(define full-frame (make-frame (make-vect -0.5 -0.5)
			       (make-vect 2 0)
			       (make-vect 0 2)))
</file>

<file path="picture_language/segment.scm">
2.48.scm
</file>

<file path="picture_language/split.scm">
2.45.scm
</file>

<file path="picture_language/up-split.scm">
2.44.scm
</file>

<file path="picture_language/vect.scm">
2.46.scm
</file>

</files>
